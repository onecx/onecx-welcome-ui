<ocx-portal-page helpArticleId="PAGE_WELCOME_EDIT" permission="IMAGE#EDIT">
  <div class="flex flex-column row-gap-3">
    <div class="flex flex-row justify-content-end column-gap-2">
      <p-button
        icon="pi pi-arrow-left"
        [routerLink]="['../']"
        [label]="'GENERAL.BACK' | translate"
        [pTooltip]="'GENERAL.TOOLTIPS.BACK' | translate"
        tooltipPosition="top"
        tooltipEvent="hover"
      ></p-button>
      <p-button
        icon="pi pi-save"
        (onClick)="this.onSaveOrder()"
        [disabled]="!this.isReordered"
        [label]="'ACTIONS.REORDER.SAVE' | translate"
        [pTooltip]="'ACTIONS.REORDER.SAVE_TOOLTIP' | translate"
        tooltipPosition="top"
        tooltipEvent="hover"
      ></p-button>
    </div>
    <div class="flex flex-row flex-wrap gap-4">
      <p-card class="w-20rem h-20rem p-overlay-badge" styleClass="" *ngFor="let info of imageInfos; let i = index">
        <ng-template pTemplate="content">
          <img
            [alt]="'image-' + i"
            [src]="this.buildImageSrc(info)"
            class="w-full h-13rem"
            style="_object-fit: cover"
          />
        </ng-template>
        <ng-template pTemplate="footer">
          <div class="flex h-full">
            <div class="action-buttons" style="margin-right: auto">
              <p-button
                class="visibilityChange"
                pTooltip="{{ 'ACTIONS.VISIBILITY.TOOLTIP' | translate }}"
                (onClick)="this.updateVisibility(info)"
                icon="{{ info.visible ? 'pi pi-eye' : 'pi pi-eye-slash' }}"
              ></p-button>
              <p-button
                ocxIfPermission="'IMAGE#DELETE'"
                pTooltip="{{ 'ACTIONS.DELETE.TOOLTIP' | translate }}"
                icon="pi pi-trash"
                styleClass="p-button-secondary"
                [style]="{ 'margin-left': '.5em' }"
                (onClick)="this.handleDelete(info.id)"
              ></p-button>
            </div>
            <div class="arrow-buttons" style="margin-left: auto">
              <p-button
                class="arrow-left"
                pTooltip="{{ 'ACTIONS.REORDER.MOVE_LEFT_TOOLTIP' | translate }}"
                [disabled]="!(i > 0)"
                icon="pi pi-arrow-left"
                [style]="{ 'margin-left': '.5em' }"
                (onClick)="this.swapElement(this.imageInfos, i, i - 1)"
              >
              </p-button>
              <p-button
                class="arrow-right"
                pTooltip="{{ 'ACTIONS.REORDER.MOVE_RIGHT_TOOLTIP' | translate }}"
                [disabled]="!(i !== imageInfos.length - 1)"
                icon="pi pi-arrow-right"
                [style]="{ 'margin-left': '.5em' }"
                (onClick)="this.swapElement(this.imageInfos, i, i + 1)"
              ></p-button>
            </div>
          </div>
        </ng-template>
      </p-card>
      <div
        *ngIf="this.imageInfos.length < 20"
        (click)="this.displayImageDialog = true"
        class="w-20rem h-20rem new-image-card flex justify-content-center align-items-center border-primary border-round-xl cursor-pointer"
        [pTooltip]="'ACTIONS.ADD.TOOLTIP' | translate"
        tooltipPosition="bottom"
      >
        <a
          tabindex="0"
          class="pi pi-plus font-bold text-3xl"
          (keydown.enter)="this.displayImageDialog = true"
          (keydown.space)="this.displayImageDialog = true"
          aria-label="'ACTIONS.ADD.LABEL' | translate"
        >
        </a>
      </div>
    </div>
  </div>
</ocx-portal-page>

<app-image-dialog
  [displayDetailDialog]="displayImageDialog"
  (hideDialogAndChanged)="onCloseDialog($event)"
  [imageInfoCount]="this.imageInfos.length"
></app-image-dialog>
